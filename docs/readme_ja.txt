BmsONE

1. 概要

BmsONE は新しい音楽ゲームフォーマットである bmson ファイルを編集するためのアプリケーションです。
bmson フォーマットについての情報は、6. 参考リンク をご覧ください。

現在、v1.0 および v0.21 の bmson ファイルに対応しています。
ただし、一部の情報はまだ編集することができません。

このドキュメントの最新版は次のURLで見られます。
http://sky.geocities.jp/exclusion_bms/bmsone.html


2. 使い方

2.1 注意

このソフトは開発途上のため、機能が不十分であったり、不安定な動作をすることがあります。
Mac版は特に頻繁にクラッシュすることがあるので気を付けてください。
bmson 制作時にはこまめにセーブすることをお勧めします。
また、編集する bmson ファイル（念のため音声ファイルも）はバックアップを取っておきましょう。

また、以下の説明でCtrlキーといっている箇所は、Mac版ではCommandキー(⌘)のことを意味します。


2.2 音声チャンネルの追加

[チャンネル] → [追加] で使用する音声ファイルを選択します（Wav、Ogg Vorbis に対応しています）。
あるいは、音声ファイルをウィンドウ内にドラッグ＆ドロップすることでもチャンネルを追加できます。


2.3 音声ノーツの配置・編集

このソフトには「編集モード」と「書込モード」の2つのモードがあり、
これらを使い分けることで効率よく譜面を作成することができます。

音声ノーツを配置するためには、まずは鉛筆のアイコンをクリックして「書込モード」にしてください。
次に、ノーツを配置したい音声チャンネルを選択します。
シーケンス表示部には各チャンネルに対応したBGMレーンが並んでおり、選択中の列が明るく表示されます。
暗くなっている列をクリックするとそのチャンネルを選択できます。
Bmsonには「音を最初から再生するノート」と「その部分で音をスライスするノート」の2種類のノートがあり、
[Shift+クリック] すると前者を、単に [クリック] すると後者を配置できます。
（音が鳴っていない部分にスライスノートを配置すると無音ノートとなります。）
また、既存のノートを右クリックすると削除されます。

BGMレーンの背景に波形が表示されていることにお気づきでしょう。
緑色の波形はその部分がBGMレーンのノートで鳴ることを、橙色はキー音として鳴ることを表します。

「編集モード」では、ノーツを範囲選択したりドラッグで横移動させたりすることができます。
また、選択したノーツ上で右クリックし、「BGM(キー)レーンに移動」を選択すると
キー音レーン上のノーツをBGMレーンに移動、あるいはその逆ができます。
Shiftキーを押しながらノーツをドラッグすると、ノートの長さを変更できます。
通常のノートは長さ0なので、ロングノートを解除したい場合は限界まで長さを短くしてください。

「編集モード」での範囲選択は、Ctrl、Alt、Shiftキーを組み合わせることで振る舞いが変わります。
例えば、Altキーを押しながら範囲選択すると選択中のチャンネルのノーツだけを選択できます。

譜面またはBGMレーン上で [Alt+右クリック]、あるいはノーツまたはBGMレーン上で [中央ボタンクリック]
すると、クリックしている間だけ現在の音声チャンネルのその時点での音声をプレビューできます。
（Macでは Controlキー（Commandキーではない）+クリックで右クリックの代わりになります。）
マスターレーン上でクリックすると、クリックしている間だけ曲全体をプレビューできます。
これらのプレビュー中にCtrlキーを押すと、再生位置に従って譜面が自動でスクロールします。


2.4 その他

[情報] ウィンドウでは曲の基本情報を入力できます。
初期BPMはノーツの配置時の操作性に影響するので最初に設定しておきましょう。

小節線はシーケンス表示部の左端にある、小節番号が表示されている部分を [Ctrl+クリック] することで
編集できます。小節番号が灰色の小節線は4拍子で自動挿入された一時的なものであり、他の小節線を
挿入したり削除した際に変化することがあります。

BPMイベントは小節番号の隣のレーンをクリックすることで編集できます。
BPMイベントを配置または選択すると、BPMを入力するための小さなツールバーが現れます。

BGAデータや他の拡張データの多くはまだ編集できませんが、未対応のデータを持つファイルを
このアプリケーションで編集してもデータは保持されます。
なお、「情報」（bmsonフォーマットの BMSInfo 部分）の拡張データは「拡張情報」欄で
次のようにJSONの断片を直接入力することで編集できます。
  "updated_at": "14:00 2015/11/14",
  "registered_with": "The Forgetalia"

設定ファイルが次のようなディレクトリに保存されます。
ウィンドウの位置がおかしくなってしまった場合などは削除してみてください。
  [Windows] C:\Users\<USER>\AppData\Local\BmsONE
  [Mac OS X] ~/Library/Preferences/BmsONE


3. 免責事項・使用条件

BmsONE の作者である exclusion はこのソフトを使用して生じたいかなる損害の責任も負いません。
また、このソフトを用い、音楽CDやゲーム等から抜き出したデータを使った違法な bmson データを
作成することを禁止します。
このソフトの再配布はアーカイブの内容を改変せず無償の場合に許可します。

このソフトは Qt をLGPLライセンスで使用しています。
同梱されているdllファイル（Mac版はapp内のFramework、PlugIn等）の類は Qt のものですので、
異なる版の Qt と差し替えて利用しても構いません。ビルド設定の情報は次項を参照してください。

不明な点がございましたらご連絡ください。
希望があればソースコードの提供も検討します。


4. 開発環境

[Windows]
Windows 10 Pro
Desktop Qt 5.7.0 MSVC2015 OpenGL 32bit

[Mac OS X]
Mac OS X 10.10.5
Desktop Qt 5.7.0 clang 64bit

[共通]
Xiph.org 様の libogg 1.3.2、libvorbis 1.3.5 を使用しています。


5. 連絡先

exclusion
Twitter: @excln
E-mail:  exclusion_bms@yahoo.co.jp
Web:     http://sky.geocities.jp/exclusion_bms/

また、動作報告や要望等についてはTwitterの #bmsone ハッシュタグでもお待ちしております。
bmson フォーマットに関する話題は #bmson ハッシュタグにお願いします。


6. 参考リンク

bmson / Bemuse Project (wosderge様)
  https://bmson.nekokan.dyndns.info/
  bmsonフォーマットの公式サイトです。

BMSまとめ @wiki - how to bmson
  http://www40.atwiki.jp/laser_bm/pages/110.html
  bmsonの作り方とプレイ方法が書かれています。（日本語）

bmson specs (flicknote様)
  https://docs.google.com/document/d/1ZDjfjWud8UG3RPjyhN-dd1rVjPaactcMT3PIODTap9s/edit
  bmsonフォーマットの仕様案と詳細な解説が書かれています。（英語）
  次期仕様を話し合うための場なので、各種ソフトが対応していない要素が含まれます。
  興味のある方はぜひコメント等を書き込んでみてください。

#bmson Creation Notes (ドルフィン様)
  https://docs.google.com/document/d/1gQKPWApeL03aO09-II7slxTeuvm3HO_FmY1D4chRvOQ/edit
  DAWの音声書き出しからエディタの使い方まで、bmson制作の一連の流れについて解説されています。（英語）


7. 履歴

2016年09月06日 beta 0.1.2
  - Circular Rhythm 用の表示モードを追加した。
  - 非アクティブなチャンネルを暗くするかどうかの設定を追加した。
  - チャンネルプレビュー時の自動スクロール機能の実装、表示性能を改善した。
  - ノートプレビューの最大の長さを設定できるようにした。
  - 音声チャンネルの検索機能を実装した。
  - 情報の「モード」の欄を主な候補から選べるようにし、表示モードも自動で切り替えるようにした。

2015年11月20日 beta 0.1.1
  - 新規作成によって作ったドキュメントにバージョン情報が含まれないバグを修正した。
  - 音声ノーツの編集時マスターキャッシュが不必要に更新される問題を修正した。

2015年11月14日 beta 0.1.0
  - スクラッチ位置の変更など、表示モードの機能を改善した。
  - マスターキャッシュ、マスターレーン、ミニマップを実装した。
  - Bmson v1.0 形式で導入されたデータの編集に対応した。

2015年11月04日 alpha 0.0.6
  - Macで環境によっては ogg ファイルの読み込み時にクラッシュする問題を修正した。
  - Macで譜面スクロール時などに頻繁にクラッシュする問題を改善した。
  - 音声チャンネルに配置された音声のプレビュー機能を実装した。
  - Bmson v1.0 形式の入出力に関する暫定的な対応を行った。
  - 7鍵盤以外の表示モードへの暫定的な対応を行った。
  - 言語などを変更できる設定画面を追加した。
  - ノーツの移動時等にショートカットキーが動作しないようにした。

2015年10月17日 alpha 0.0.5
  - 「元に戻す」「やり直し」を実装した。
  - 編集モードを新たに追加し、ノーツの移動やLNの編集が可能になった。
  - 選択したオブジェクトをまとめて削除したり、キー音レーン・BGMレーン間を移動できるようになった。
  - 情報・チャンネルビューのUIを少々変更した。
  - いくつかの軽微なバグ修正とパフォーマンス改善を行った。

2015年09月27日 alpha 0.0.4
  - BGMレーンのノートをプレビューした時におかしくなるバグを修正した。
  - 拡張情報や音声ファイル名にもユニコード文字が使えるようになった。
  - EXEファイルへのD&Dでファイルを開けるようになった。（Windowsのみ）

2015年09月26日 alpha 0.0.3
  - Qt をバージョン 5.4.1 から 5.5.0 にアップグレードした。
  - ステータスバーなどのUI要素を実装した。
  - Macでクラッシュする主な要因を修正した。
  - 小節線とBPMイベントが編集可能になった。
  - BGAなどの未対応のデータが消えてしまわないようにした。
  - 波形表示のバグを大方修正した。
  - 設定ファイルにウィンドウの位置などの情報を記録するようにした。

2015年09月17日 alpha 0.0.2

2015年09月12日 alpha 0.0.1
